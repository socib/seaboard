// Generated by CoffeeScript 1.6.2
(function() {
  var _ref,
    __bind = function(fn, me) {
      return function() {
        return fn.apply(me, arguments);
      };
    },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) {
      for (var key in parent) {
        if (__hasProp.call(parent, key)) child[key] = parent[key];
      }

      function ctor() {
        this.constructor = child;
      }
      ctor.prototype = parent.prototype;
      child.prototype = new ctor();
      child.__super__ = parent.prototype;
      return child;
    };

  var inputUnits = {
    'sea_water_temperature': '°C',
    'sea_water_salinity': 'psu',
    'sea_water_electrical_conductivity': 'ms cm-1',
    'speed': 'm s-1',
    'wind_speed': 'm s-1',
    'wind_speed_mean': 'm s-1',
    'air_pressure': 'hPa',
    'humidity': '%',
    'air_temperature': '°C',
    'sun_radiation': 'W m^2-1'
  }

  Dashing.VesselChart = (function(_super) {
    __extends(VesselChart, _super);

    function VesselChart() {
      this.initialData = __bind(this.initialData, this);
      _ref = VesselChart.__super__.constructor.apply(this, arguments);
      return _ref;
    }

    VesselChart.prototype.ready = function() {
      $(this.node).addClass(this.get('id'));
    };

    VesselChart.prototype.onData = function(data) {
      var chart = $(this.node).highcharts();
      var series = chart.series[0];

      var d = new Date();
      var x = d.parseFormat(data.time, 'dd-mm-yyyy HH:MM:ss').getTime();
      var y = parseFloat(data[this.get('id')]);
      if ( series.xData[series.xData.length - 1] != x){
        series.addPoint([x, y], true, true);        
      }

    };

    VesselChart.prototype.initialData = function(data) {
      var standardName = this.get('id');
      var variableTitle = this.get('title');

      $(this.node).highcharts('StockChart', {
        navigator: {
          enabled: false
        },
        title: {
          text: variableTitle
        },
        global: {
          useUTC: false
        },
        series: [{
          name: variableTitle,
          data: (function() {
            var variable_data = data[standardName];
            var length = variable_data.length;
            var series_data = [];
            var d = new Date();
            for (var i = 0; i < length; i++) {
              series_data.push([d.parseFormat(data.time[i], 'dd-mm-yyyy HH:MM:ss').getTime(), parseFloat(variable_data[i])]);
            }
            return series_data;
          })(),
          tooltip: {
            yDecimals: 2
          }
        }],
        rangeSelector: {
          enabled: false
        },

      });
    };


    return VesselChart;

  })(Dashing.Widget);

}).call(this);